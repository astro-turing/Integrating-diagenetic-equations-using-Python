<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.7.0"/>
    <title>marlpde.parameters API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../marlpde.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;marlpde</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#u">u</a>
            </li>
            <li>
                    <a class="variable" href="#quantity">quantity</a>
            </li>
            <li>
                    <a class="class" href="#Scenario">Scenario</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Scenario.__init__">Scenario</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.mua">mua</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.rhoa">rhoa</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.rhoc">rhoc</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.rhot">rhot</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.rhow">rhow</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.D0ca">D0ca</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.D0co3">D0co3</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.Ka">Ka</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.Kc">Kc</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.beta">beta</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.b">b</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.k1">k1</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.k2">k2</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.k3">k3</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.k4">k4</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.nn">nn</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.m">m</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.S">S</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.phiinf">phiinf</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.phi0">phi0</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.ca0">ca0</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.co30">co30</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.ccal0">ccal0</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.cara0">cara0</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.xdis">xdis</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.length">length</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.Th">Th</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.phi00">phi00</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.ca00">ca00</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.co300">co300</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.ccal00">ccal00</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scenario.cara00">cara00</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#Map_Scenario">Map_Scenario</a>
            </li>
            <li>
                    <a class="function" href="#jacobian_sparsity">jacobian_sparsity</a>
            </li>
            <li>
                    <a class="class" href="#Solver">Solver</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Solver.__init__">Solver</a>
                        </li>
                        <li>
                                <a class="variable" href="#Solver.first_step">first_step</a>
                        </li>
                        <li>
                                <a class="variable" href="#Solver.atol">atol</a>
                        </li>
                        <li>
                                <a class="variable" href="#Solver.rtol">rtol</a>
                        </li>
                        <li>
                                <a class="variable" href="#Solver.t_span">t_span</a>
                        </li>
                        <li>
                                <a class="variable" href="#Solver.method">method</a>
                        </li>
                        <li>
                                <a class="variable" href="#Solver.lband">lband</a>
                        </li>
                        <li>
                                <a class="variable" href="#Solver.uband">uband</a>
                        </li>
                        <li>
                                <a class="variable" href="#Solver.backend">backend</a>
                        </li>
                        <li>
                                <a class="variable" href="#Solver.dense_output">dense_output</a>
                        </li>
                        <li>
                                <a class="variable" href="#Solver.jac_sparsity">jac_sparsity</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Tracker">Tracker</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Tracker.__init__">Tracker</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tracker.no_progress_updates">no_progress_updates</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tracker.no_t_eval">no_t_eval</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tracker.t_eval">t_eval</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../marlpde.html">marlpde</a><wbr>.parameters    </h1>

                
                        <input id="mod-parameters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-parameters-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="p">(</span><span class="n">dataclass</span><span class="p">,</span> <span class="n">make_dataclass</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="kn">from</span> <span class="nn">pint</span> <span class="kn">import</span> <span class="n">UnitRegistry</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">lil_matrix</span><span class="p">,</span> <span class="n">dia_matrix</span><span class="p">,</span> <span class="n">csr_matrix</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="n">u</span> <span class="o">=</span> <span class="n">UnitRegistry</span><span class="p">()</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="n">quantity</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="nd">@dataclass</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="k">class</span> <span class="nc">Scenario</span><span class="p">:</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="sd">    Sets all the Scenario parameter values from the FORTRAN code from </span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="sd">    L&#39;Heureux (2018). Strictly, the initial and boundary porosities are not</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="sd">    part of the Scenario parameters, but they are included here.</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a>    <span class="n">mua</span><span class="p">:</span> <span class="n">quantity</span>    <span class="o">=</span> <span class="mf">100.09</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">g</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">mol</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>    <span class="n">rhoa</span><span class="p">:</span> <span class="n">quantity</span>   <span class="o">=</span> <span class="mf">2.95</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">g</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">3</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>    <span class="n">rhoc</span><span class="p">:</span> <span class="n">quantity</span>   <span class="o">=</span> <span class="mf">2.71</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">g</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">3</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>    <span class="n">rhot</span><span class="p">:</span> <span class="n">quantity</span>   <span class="o">=</span> <span class="mf">2.8</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">g</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">3</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>    <span class="n">rhow</span><span class="p">:</span> <span class="n">quantity</span>   <span class="o">=</span> <span class="mf">1.023</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">g</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">3</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>    <span class="n">D0ca</span><span class="p">:</span> <span class="n">quantity</span>   <span class="o">=</span> <span class="mf">131.9</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">a</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>    <span class="n">D0co3</span><span class="p">:</span> <span class="n">quantity</span>  <span class="o">=</span> <span class="mf">272.6</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">a</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>    <span class="n">Ka</span><span class="p">:</span> <span class="n">quantity</span>     <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.19</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">M</span><span class="o">**</span><span class="mi">2</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>    <span class="n">Kc</span><span class="p">:</span> <span class="n">quantity</span>     <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.37</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">M</span><span class="o">**</span><span class="mi">2</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>    <span class="n">beta</span><span class="p">:</span> <span class="n">quantity</span>   <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">a</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>    <span class="n">b</span><span class="p">:</span> <span class="n">quantity</span>      <span class="o">=</span> <span class="mf">5.0</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">kPa</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>    <span class="n">k1</span><span class="p">:</span> <span class="n">quantity</span>     <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">a</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>    <span class="n">k2</span><span class="p">:</span> <span class="n">quantity</span>     <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">a</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>    <span class="n">k3</span><span class="p">:</span> <span class="n">quantity</span>     <span class="o">=</span> <span class="mf">0.1</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">a</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>    <span class="n">k4</span><span class="p">:</span> <span class="n">quantity</span>     <span class="o">=</span> <span class="mf">0.1</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">a</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>    <span class="n">nn</span><span class="p">:</span> <span class="n">quantity</span>     <span class="o">=</span> <span class="mf">2.8</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>    <span class="n">m</span><span class="p">:</span> <span class="n">quantity</span>      <span class="o">=</span> <span class="mf">2.48</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>    <span class="n">S</span><span class="p">:</span> <span class="n">quantity</span>      <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">a</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>    <span class="c1"># cAthy: quantity  = 0.1 * u.dimensionless</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>    <span class="n">phiinf</span><span class="p">:</span> <span class="n">quantity</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>    <span class="n">phi0</span><span class="p">:</span> <span class="n">quantity</span>   <span class="o">=</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>    <span class="n">ca0</span><span class="p">:</span> <span class="n">quantity</span>    <span class="o">=</span> <span class="mf">0.326e-3</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">M</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>    <span class="n">co30</span><span class="p">:</span> <span class="n">quantity</span>   <span class="o">=</span> <span class="mf">0.326e-3</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">M</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>    <span class="n">ccal0</span><span class="p">:</span> <span class="n">quantity</span>  <span class="o">=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>    <span class="n">cara0</span><span class="p">:</span> <span class="n">quantity</span>  <span class="o">=</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>    <span class="n">xdis</span><span class="p">:</span> <span class="n">quantity</span>   <span class="o">=</span> <span class="mf">50.0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span>       <span class="c1"># x_d   (start of dissolution zone)</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>    <span class="n">length</span><span class="p">:</span> <span class="n">quantity</span> <span class="o">=</span> <span class="mf">500.0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>    <span class="n">Th</span><span class="p">:</span> <span class="n">quantity</span>     <span class="o">=</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span>      <span class="c1"># h_d   (height of dissolution zone)</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>    <span class="n">phi00</span><span class="p">:</span> <span class="n">quantity</span>  <span class="o">=</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>    <span class="n">ca00</span><span class="p">:</span> <span class="n">quantity</span>   <span class="o">=</span> <span class="mf">0.326e-3</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">M</span>    <span class="c1"># sqrt(Kc) / 2</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>    <span class="n">co300</span><span class="p">:</span> <span class="n">quantity</span>  <span class="o">=</span> <span class="mf">0.326e-3</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">M</span>    <span class="c1"># sqrt(Kc) / 2</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>    <span class="n">ccal00</span><span class="p">:</span> <span class="n">quantity</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>    <span class="n">cara00</span><span class="p">:</span> <span class="n">quantity</span> <span class="o">=</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="k">def</span> <span class="nf">Map_Scenario</span><span class="p">():</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">    Maps the Fortran &#39;Scenario&#39; parameters to the equivalent parameters in the</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">    Matlab and Python codes. These codes use slightly different parameter </span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">    names. Besides the mapping, also a few numerical conversions are applied.</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">    To do these conversions, a number of FORTRAN parameters need to be passed on </span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">    &quot;as is&quot;, i.e. unchanged.</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">    Units from Scenario are dropped, so only magnitudes (i.e. values) are </span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">    retained.</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Ka&quot;</span><span class="p">:</span><span class="s2">&quot;KA&quot;</span><span class="p">,</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>               <span class="s2">&quot;Kc&quot;</span><span class="p">:</span><span class="s2">&quot;KC&quot;</span><span class="p">,</span> 
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>               <span class="s2">&quot;cara0&quot;</span><span class="p">:</span> <span class="s2">&quot;CA0&quot;</span><span class="p">,</span> 
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>               <span class="s2">&quot;cara00&quot;</span><span class="p">:</span> <span class="s2">&quot;CAIni&quot;</span><span class="p">,</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>               <span class="s2">&quot;ccal0&quot;</span><span class="p">:</span> <span class="s2">&quot;CC0&quot;</span><span class="p">,</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>               <span class="s2">&quot;ccal00&quot;</span><span class="p">:</span> <span class="s2">&quot;CCIni&quot;</span><span class="p">,</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>               <span class="s2">&quot;ca0&quot;</span><span class="p">:</span> <span class="s2">&quot;ca0&quot;</span><span class="p">,</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>               <span class="s2">&quot;ca00&quot;</span><span class="p">:</span> <span class="s2">&quot;ca00&quot;</span><span class="p">,</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>               <span class="s2">&quot;co30&quot;</span><span class="p">:</span> <span class="s2">&quot;co30&quot;</span><span class="p">,</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>               <span class="s2">&quot;co300&quot;</span><span class="p">:</span> <span class="s2">&quot;co300&quot;</span><span class="p">,</span>               
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>               <span class="s2">&quot;phi0&quot;</span><span class="p">:</span> <span class="s2">&quot;Phi0&quot;</span><span class="p">,</span> 
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>               <span class="s2">&quot;phi00&quot;</span><span class="p">:</span><span class="s2">&quot;PhiIni&quot;</span><span class="p">,</span> 
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>               <span class="s2">&quot;xdis&quot;</span><span class="p">:</span> <span class="s2">&quot;ShallowLimit&quot;</span><span class="p">,</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>               <span class="s2">&quot;Th&quot;</span><span class="p">:</span> <span class="s2">&quot;Th&quot;</span><span class="p">,</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>               <span class="s2">&quot;S&quot;</span><span class="p">:</span> <span class="s2">&quot;sedimentationrate&quot;</span><span class="p">,</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>               <span class="s2">&quot;m&quot;</span><span class="p">:</span> <span class="s2">&quot;m1&quot;</span><span class="p">,</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>               <span class="s2">&quot;nn&quot;</span><span class="p">:</span> <span class="s2">&quot;n1&quot;</span><span class="p">,</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>               <span class="s2">&quot;rhoa&quot;</span><span class="p">:</span> <span class="s2">&quot;rhoa&quot;</span><span class="p">,</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>               <span class="s2">&quot;rhoc&quot;</span><span class="p">:</span> <span class="s2">&quot;rhoc&quot;</span><span class="p">,</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>               <span class="s2">&quot;rhot&quot;</span><span class="p">:</span> <span class="s2">&quot;rhot&quot;</span><span class="p">,</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>               <span class="s2">&quot;rhow&quot;</span><span class="p">:</span> <span class="s2">&quot;rhow&quot;</span><span class="p">,</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>               <span class="s2">&quot;beta&quot;</span><span class="p">:</span> <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>               <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>               <span class="s2">&quot;D0ca&quot;</span><span class="p">:</span> <span class="s2">&quot;D0Ca&quot;</span><span class="p">,</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>               <span class="s2">&quot;k1&quot;</span><span class="p">:</span> <span class="s2">&quot;k1&quot;</span><span class="p">,</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>               <span class="s2">&quot;k2&quot;</span><span class="p">:</span> <span class="s2">&quot;k2&quot;</span><span class="p">,</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>               <span class="s2">&quot;k3&quot;</span><span class="p">:</span> <span class="s2">&quot;k3&quot;</span><span class="p">,</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>               <span class="s2">&quot;k4&quot;</span><span class="p">:</span> <span class="s2">&quot;k4&quot;</span><span class="p">,</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>               <span class="s2">&quot;mua&quot;</span><span class="p">:</span> <span class="s2">&quot;muA&quot;</span><span class="p">,</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>               <span class="s2">&quot;D0co3&quot;</span><span class="p">:</span> <span class="s2">&quot;DCO3&quot;</span><span class="p">,</span>  
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>               <span class="s2">&quot;phiinf&quot;</span><span class="p">:</span> <span class="s2">&quot;PhiInfty&quot;</span><span class="p">,</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>               <span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="s2">&quot;max_depth&quot;</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>    <span class="p">}</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>    <span class="n">all_fields</span> <span class="o">=</span> <span class="n">fields</span><span class="p">(</span><span class="n">Scenario</span><span class="p">)</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>    <span class="n">allowed_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">all_fields</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>                      <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">mapping</span><span class="p">]</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>    
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>    <span class="n">derived_fields</span> <span class="o">=</span> <span class="p">[(</span><span class="n">mapping</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">field</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">default</span><span class="o">.</span><span class="n">magnitude</span><span class="p">)</span> 
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>                      <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">allowed_fields</span><span class="p">]</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>                    
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>    <span class="c1"># Here we append the fields that cannot be initialised directly from the</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>    <span class="c1"># Scenario dataclass.</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>    <span class="n">derived_fields</span><span class="o">.</span><span class="n">extend</span><span class="p">([(</span><span class="s2">&quot;cCa0&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>                           <span class="p">(</span><span class="s2">&quot;cCaIni&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>                           <span class="p">(</span><span class="s2">&quot;cCO30&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>                           <span class="p">(</span><span class="s2">&quot;cCO3Ini&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>                           <span class="p">(</span><span class="s2">&quot;DeepLimit&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>                           <span class="p">(</span><span class="s2">&quot;rhos0&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>                           <span class="p">(</span><span class="s2">&quot;rhos&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>                           <span class="p">(</span><span class="s2">&quot;Xstar&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>                           <span class="p">(</span><span class="s2">&quot;Tstar&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>                           <span class="p">(</span><span class="s2">&quot;m2&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>                           <span class="p">(</span><span class="s2">&quot;n2&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>                           <span class="p">(</span><span class="s2">&quot;DCa&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>                           <span class="p">(</span><span class="s2">&quot;PhiNR&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>                           <span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>                           <span class="p">(</span><span class="s2">&quot;FV_switch&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">)])</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>    <span class="k">def</span> <span class="nf">post_init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>        <span class="c1"># The Python parameters that need additional conversion</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>        <span class="c1"># are initialised here.   </span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cCa0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca0</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">KC</span><span class="p">)</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cCaIni</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca00</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">KC</span><span class="p">)</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cCO30</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">co30</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">KC</span><span class="p">)</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cCO3Ini</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">co300</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">KC</span><span class="p">)</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DeepLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ShallowLimit</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Th</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rhos0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rhoa</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">CA0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rhoc</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">CC0</span> <span class="o">+</span> \
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>                     <span class="bp">self</span><span class="o">.</span> <span class="n">rhot</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CA0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">CC0</span><span class="p">))</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rhos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rhos0</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Xstar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">D0Ca</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sedimentationrate</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Tstar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Xstar</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sedimentationrate</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">/</span><span class="mf">1e4</span><span class="p">)</span> 
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m1</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n1</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DCa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">D0Ca</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">PhiNR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PhiIni</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>        <span class="c1"># The number of cells that comprise the grid.</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="mi">200</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>        <span class="c1"># It could be that F-V caused instabilities instead of resolving them,</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>        <span class="c1"># e.g. in the case of oscillations.</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>        <span class="c1"># FV_switch = 1 will use the Fiadeiro-Veronis scheme for spatial derivatives.</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">FV_switch</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>               
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>    <span class="n">derived_dataclass</span> <span class="o">=</span> <span class="n">make_dataclass</span><span class="p">(</span><span class="s2">&quot;Mapped parameters&quot;</span><span class="p">,</span> <span class="n">derived_fields</span><span class="p">,</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>                                       <span class="n">namespace</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;__post_init__&quot;</span><span class="p">:</span> <span class="n">post_init</span><span class="p">})</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>    <span class="k">return</span> <span class="n">derived_dataclass</span><span class="p">()</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a><span class="k">def</span> <span class="nf">jacobian_sparsity</span><span class="p">():</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a><span class="sd">    It turns out the the Jacobian sparsity matrix, as provided by</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a><span class="sd">    previous versions of this function was too strict. The diagonals</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a><span class="sd">    had a width of 1, this implicitly assumes no dependencies of the</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="sd">    Jacobian elements on fields at adjacent depths. A run with such</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="sd">    a Jacobian sparsity matrix took a lot of compute power and time and</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="sd">    ultimately halted without covering a single time step! A debugging </span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="sd">    session with breakpoints inside solve_ivp showed that the Jacobian </span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="sd">    matrix computed by `solve_ivp` (when neither the Jacobian nor the </span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">    Jacobian sparsity matrix was provided) has non-zero elements not </span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">    only on the diagonals but also on adjacent positions along the </span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">    diagonals. </span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">    See equation 2.58 from &quot;Finite Difference Methods Finite for Differential</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="sd">    Equations by Randall J. Leveque for an example of off-diagonal Jacobian</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a><span class="sd">    matrix elements. This example is about the Jacobian for solving the pde </span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">    describing the motion of a pendulum with a certain mass at the end of a </span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="sd">    rigid (but massless) bar.</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a><span class="sd">    Here we will choose diagonals of width 3.</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>    <span class="n">no_depths</span> <span class="o">=</span> <span class="n">Map_Scenario</span><span class="p">()</span><span class="o">.</span><span class="n">N</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>    <span class="c1"># Number of fields = 5, i.e. calcite, aragonite, concentrations of</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>    <span class="c1"># calcium and carbonate ions and the porosity.</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>    <span class="n">no_fields</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">no_fields</span> <span class="o">*</span> <span class="n">no_depths</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>    
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>    <span class="n">diagonals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">no_fields</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">n</span><span class="p">))</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>    <span class="c1"># Construct the offsets.</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>    <span class="n">offsets</span> <span class="o">=</span> <span class="p">()</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>    <span class="k">for</span> <span class="n">offset</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">n</span> <span class="o">+</span> <span class="n">no_depths</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="n">no_depths</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">no_depths</span><span class="p">):</span> 
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>        <span class="n">offsets</span> <span class="o">=</span> <span class="n">offsets</span> <span class="o">+</span> <span class="p">((</span><span class="n">offset</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">offset</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),)</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>    <span class="c1"># Turn offsets into a single tuple instead of a tuple of tuples.</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>    <span class="n">offsets</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">offsets</span><span class="p">,</span> <span class="p">())</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>    <span class="c1"># Check that we have as many offsets as diagonals:</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">offsets</span><span class="p">)</span> <span class="o">==</span> <span class="n">diagonals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>    <span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Assertion failed at the </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s1"> line. </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Setup of diagonals incorrect.&#39;</span><span class="p">)</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>    <span class="c1"># Construct the sparse matrix. </span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>    <span class="n">raw_matrix</span> <span class="o">=</span> <span class="n">lil_matrix</span><span class="p">(</span><span class="n">dia_matrix</span><span class="p">((</span><span class="n">diagonals</span><span class="p">,</span> <span class="n">offsets</span><span class="p">),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)))</span> 
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>    <span class="c1"># Set the Jacobian elements to zero that correspond with the derivatives</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>    <span class="c1"># of the rhs of equations 40 and 41 wrt phi.</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>    <span class="n">raw_matrix</span><span class="p">[:</span><span class="mi">2</span> <span class="o">*</span> <span class="n">no_depths</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">no_depths</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>    <span class="k">return</span> <span class="n">csr_matrix</span><span class="p">(</span><span class="n">raw_matrix</span><span class="p">)</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a><span class="nd">@dataclass</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a><span class="k">class</span> <span class="nc">Solver</span><span class="p">():</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a><span class="sd">    Initialises all the parameters for the solver.</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a><span class="sd">    So parameters like time interval, time step and tolerance.</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>    <span class="n">first_step</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>    <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>    <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>    <span class="c1"># t_span is a tuple (begin time, end time) of integration in units of T*.</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>    <span class="n">t_span</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>    <span class="c1"># solve_ivp from scipy offers six methods. They can be set here.</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Radau&quot;</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>    <span class="c1"># Setting lband and uband for method=&quot;LSODA&quot; leads to tremendous performance</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>    <span class="c1"># increase. See Scipy&#39;s solve_ivp documentation for background. Consider it</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>    <span class="c1"># equivalent to providing a sparsity matrix for the &quot;Radau&quot; and &quot;BDF&quot;</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>    <span class="c1"># implicit methods.</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>    <span class="n">lband</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>    <span class="n">uband</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>    <span class="n">backend</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;numba&quot;</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>    <span class="n">dense_output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>    <span class="n">jac_sparsity</span><span class="p">:</span> <span class="n">csr_matrix</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>    
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a><span class="sd">        Filter out solver settings that are mutually incompatible.</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;LSODA&quot;</span><span class="p">:</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dataclass_fields__</span><span class="p">[</span><span class="s2">&quot;jac_sparsity&quot;</span><span class="p">]</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dataclass_fields__</span><span class="p">[</span><span class="s2">&quot;lband&quot;</span><span class="p">]</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dataclass_fields__</span><span class="p">[</span><span class="s2">&quot;uband&quot;</span><span class="p">]</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>                
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;Radau&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;BDF&quot;</span><span class="p">:</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">jac_sparsity</span> <span class="o">=</span> <span class="n">jacobian_sparsity</span><span class="p">()</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dataclass_fields__</span><span class="p">[</span><span class="s2">&quot;jac_sparsity&quot;</span><span class="p">]</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>            <span class="k">pass</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="nd">@dataclass</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a><span class="k">class</span> <span class="nc">Tracker</span><span class="p">:</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a><span class="sd">    Settings for tracking progress and for storing intermediate results when </span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="sd">    solve_ivp runs.</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>    <span class="c1"># Number of progress updates. This only affects the progress bar.</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>    <span class="n">no_progress_updates</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100_000</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>    <span class="c1"># Number of times to evaluate, for storage.</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>    <span class="c1"># 2 means only initial and end values.</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>    <span class="n">no_t_eval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>    <span class="c1"># Array with all times that solutions from solve_ivp should be recorded.</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>    <span class="n">t_eval</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">Solver</span><span class="p">()</span><span class="o">.</span><span class="n">t_span</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_t_eval</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="u">
                    <div class="attr variable">
            <span class="name">u</span>        =
<span class="default_value">&lt;pint.registry.UnitRegistry object&gt;</span>

        
    </div>
    <a class="headerlink" href="#u"></a>
    
    

                </section>
                <section id="quantity">
                    <div class="attr variable">
            <span class="name">quantity</span>        =
<span class="default_value">&lt;class &#39;pint.Quantity&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#quantity"></a>
    
    

                </section>
                <section id="Scenario">
                            <input id="Scenario-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass</div>

    <span class="def">class</span>
    <span class="name">Scenario</span>:

                <label class="view-source-button" for="Scenario-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Scenario"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Scenario-10"><a href="#Scenario-10"><span class="linenos">10</span></a><span class="nd">@dataclass</span>
</span><span id="Scenario-11"><a href="#Scenario-11"><span class="linenos">11</span></a><span class="k">class</span> <span class="nc">Scenario</span><span class="p">:</span>
</span><span id="Scenario-12"><a href="#Scenario-12"><span class="linenos">12</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Scenario-13"><a href="#Scenario-13"><span class="linenos">13</span></a><span class="sd">    Sets all the Scenario parameter values from the FORTRAN code from </span>
</span><span id="Scenario-14"><a href="#Scenario-14"><span class="linenos">14</span></a><span class="sd">    L&#39;Heureux (2018). Strictly, the initial and boundary porosities are not</span>
</span><span id="Scenario-15"><a href="#Scenario-15"><span class="linenos">15</span></a><span class="sd">    part of the Scenario parameters, but they are included here.</span>
</span><span id="Scenario-16"><a href="#Scenario-16"><span class="linenos">16</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="Scenario-17"><a href="#Scenario-17"><span class="linenos">17</span></a>    <span class="n">mua</span><span class="p">:</span> <span class="n">quantity</span>    <span class="o">=</span> <span class="mf">100.09</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">g</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">mol</span>
</span><span id="Scenario-18"><a href="#Scenario-18"><span class="linenos">18</span></a>    <span class="n">rhoa</span><span class="p">:</span> <span class="n">quantity</span>   <span class="o">=</span> <span class="mf">2.95</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">g</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">3</span>
</span><span id="Scenario-19"><a href="#Scenario-19"><span class="linenos">19</span></a>    <span class="n">rhoc</span><span class="p">:</span> <span class="n">quantity</span>   <span class="o">=</span> <span class="mf">2.71</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">g</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">3</span>
</span><span id="Scenario-20"><a href="#Scenario-20"><span class="linenos">20</span></a>    <span class="n">rhot</span><span class="p">:</span> <span class="n">quantity</span>   <span class="o">=</span> <span class="mf">2.8</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">g</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">3</span>
</span><span id="Scenario-21"><a href="#Scenario-21"><span class="linenos">21</span></a>    <span class="n">rhow</span><span class="p">:</span> <span class="n">quantity</span>   <span class="o">=</span> <span class="mf">1.023</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">g</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">3</span>
</span><span id="Scenario-22"><a href="#Scenario-22"><span class="linenos">22</span></a>    <span class="n">D0ca</span><span class="p">:</span> <span class="n">quantity</span>   <span class="o">=</span> <span class="mf">131.9</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">a</span>
</span><span id="Scenario-23"><a href="#Scenario-23"><span class="linenos">23</span></a>    <span class="n">D0co3</span><span class="p">:</span> <span class="n">quantity</span>  <span class="o">=</span> <span class="mf">272.6</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">a</span>
</span><span id="Scenario-24"><a href="#Scenario-24"><span class="linenos">24</span></a>    <span class="n">Ka</span><span class="p">:</span> <span class="n">quantity</span>     <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.19</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">M</span><span class="o">**</span><span class="mi">2</span>
</span><span id="Scenario-25"><a href="#Scenario-25"><span class="linenos">25</span></a>    <span class="n">Kc</span><span class="p">:</span> <span class="n">quantity</span>     <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.37</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">M</span><span class="o">**</span><span class="mi">2</span>
</span><span id="Scenario-26"><a href="#Scenario-26"><span class="linenos">26</span></a>    <span class="n">beta</span><span class="p">:</span> <span class="n">quantity</span>   <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">a</span>
</span><span id="Scenario-27"><a href="#Scenario-27"><span class="linenos">27</span></a>    <span class="n">b</span><span class="p">:</span> <span class="n">quantity</span>      <span class="o">=</span> <span class="mf">5.0</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">kPa</span>
</span><span id="Scenario-28"><a href="#Scenario-28"><span class="linenos">28</span></a>    <span class="n">k1</span><span class="p">:</span> <span class="n">quantity</span>     <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">a</span>
</span><span id="Scenario-29"><a href="#Scenario-29"><span class="linenos">29</span></a>    <span class="n">k2</span><span class="p">:</span> <span class="n">quantity</span>     <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">a</span>
</span><span id="Scenario-30"><a href="#Scenario-30"><span class="linenos">30</span></a>    <span class="n">k3</span><span class="p">:</span> <span class="n">quantity</span>     <span class="o">=</span> <span class="mf">0.1</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">a</span>
</span><span id="Scenario-31"><a href="#Scenario-31"><span class="linenos">31</span></a>    <span class="n">k4</span><span class="p">:</span> <span class="n">quantity</span>     <span class="o">=</span> <span class="mf">0.1</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">a</span>
</span><span id="Scenario-32"><a href="#Scenario-32"><span class="linenos">32</span></a>    <span class="n">nn</span><span class="p">:</span> <span class="n">quantity</span>     <span class="o">=</span> <span class="mf">2.8</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span>
</span><span id="Scenario-33"><a href="#Scenario-33"><span class="linenos">33</span></a>    <span class="n">m</span><span class="p">:</span> <span class="n">quantity</span>      <span class="o">=</span> <span class="mf">2.48</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span>
</span><span id="Scenario-34"><a href="#Scenario-34"><span class="linenos">34</span></a>    <span class="n">S</span><span class="p">:</span> <span class="n">quantity</span>      <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">a</span>
</span><span id="Scenario-35"><a href="#Scenario-35"><span class="linenos">35</span></a>    <span class="c1"># cAthy: quantity  = 0.1 * u.dimensionless</span>
</span><span id="Scenario-36"><a href="#Scenario-36"><span class="linenos">36</span></a>    <span class="n">phiinf</span><span class="p">:</span> <span class="n">quantity</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span>
</span><span id="Scenario-37"><a href="#Scenario-37"><span class="linenos">37</span></a>    <span class="n">phi0</span><span class="p">:</span> <span class="n">quantity</span>   <span class="o">=</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span>
</span><span id="Scenario-38"><a href="#Scenario-38"><span class="linenos">38</span></a>    <span class="n">ca0</span><span class="p">:</span> <span class="n">quantity</span>    <span class="o">=</span> <span class="mf">0.326e-3</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">M</span>
</span><span id="Scenario-39"><a href="#Scenario-39"><span class="linenos">39</span></a>    <span class="n">co30</span><span class="p">:</span> <span class="n">quantity</span>   <span class="o">=</span> <span class="mf">0.326e-3</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">M</span>
</span><span id="Scenario-40"><a href="#Scenario-40"><span class="linenos">40</span></a>    <span class="n">ccal0</span><span class="p">:</span> <span class="n">quantity</span>  <span class="o">=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span>
</span><span id="Scenario-41"><a href="#Scenario-41"><span class="linenos">41</span></a>    <span class="n">cara0</span><span class="p">:</span> <span class="n">quantity</span>  <span class="o">=</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span>
</span><span id="Scenario-42"><a href="#Scenario-42"><span class="linenos">42</span></a>    <span class="n">xdis</span><span class="p">:</span> <span class="n">quantity</span>   <span class="o">=</span> <span class="mf">50.0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span>       <span class="c1"># x_d   (start of dissolution zone)</span>
</span><span id="Scenario-43"><a href="#Scenario-43"><span class="linenos">43</span></a>    <span class="n">length</span><span class="p">:</span> <span class="n">quantity</span> <span class="o">=</span> <span class="mf">500.0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span>
</span><span id="Scenario-44"><a href="#Scenario-44"><span class="linenos">44</span></a>    <span class="n">Th</span><span class="p">:</span> <span class="n">quantity</span>     <span class="o">=</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span>      <span class="c1"># h_d   (height of dissolution zone)</span>
</span><span id="Scenario-45"><a href="#Scenario-45"><span class="linenos">45</span></a>    <span class="n">phi00</span><span class="p">:</span> <span class="n">quantity</span>  <span class="o">=</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span>
</span><span id="Scenario-46"><a href="#Scenario-46"><span class="linenos">46</span></a>    <span class="n">ca00</span><span class="p">:</span> <span class="n">quantity</span>   <span class="o">=</span> <span class="mf">0.326e-3</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">M</span>    <span class="c1"># sqrt(Kc) / 2</span>
</span><span id="Scenario-47"><a href="#Scenario-47"><span class="linenos">47</span></a>    <span class="n">co300</span><span class="p">:</span> <span class="n">quantity</span>  <span class="o">=</span> <span class="mf">0.326e-3</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">M</span>    <span class="c1"># sqrt(Kc) / 2</span>
</span><span id="Scenario-48"><a href="#Scenario-48"><span class="linenos">48</span></a>    <span class="n">ccal00</span><span class="p">:</span> <span class="n">quantity</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span>
</span><span id="Scenario-49"><a href="#Scenario-49"><span class="linenos">49</span></a>    <span class="n">cara00</span><span class="p">:</span> <span class="n">quantity</span> <span class="o">=</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span>
</span></pre></div>


            <div class="docstring"><p>Sets all the Scenario parameter values from the FORTRAN code from 
L'Heureux (2018). Strictly, the initial and boundary porosities are not
part of the Scenario parameters, but they are included here.</p>
</div>


                            <div id="Scenario.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">Scenario</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">mua</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">100.09</span><span class="p">,</span> <span class="s1">&#39;gram / mole&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">rhoa</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">2.95</span><span class="p">,</span> <span class="s1">&#39;gram / centimeter ** 3&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">rhoc</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">2.71</span><span class="p">,</span> <span class="s1">&#39;gram / centimeter ** 3&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">rhot</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">2.8</span><span class="p">,</span> <span class="s1">&#39;gram / centimeter ** 3&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">rhow</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">1.023</span><span class="p">,</span> <span class="s1">&#39;gram / centimeter ** 3&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">D0ca</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">131.9</span><span class="p">,</span> <span class="s1">&#39;centimeter ** 2 / year&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">D0co3</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">272.6</span><span class="p">,</span> <span class="s1">&#39;centimeter ** 2 / year&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">Ka</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">6.45654229e-07</span><span class="p">,</span> <span class="s1">&#39;molar ** 2&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">Kc</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">4.26579519e-07</span><span class="p">,</span> <span class="s1">&#39;molar ** 2&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">beta</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;centimeter / year&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">b</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span> <span class="s1">&#39;1 / kilopascal&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">k1</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;1 / year&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">k2</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;1 / year&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">k3</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;1 / year&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">k4</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;1 / year&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">nn</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">2.8</span><span class="p">,</span> <span class="s1">&#39;dimensionless&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">m</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">2.48</span><span class="p">,</span> <span class="s1">&#39;dimensionless&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">S</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;centimeter / year&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">phiinf</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="s1">&#39;dimensionless&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">phi0</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="s1">&#39;dimensionless&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">ca0</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.000326</span><span class="p">,</span> <span class="s1">&#39;molar&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">co30</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.000326</span><span class="p">,</span> <span class="s1">&#39;molar&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">ccal0</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;dimensionless&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">cara0</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="s1">&#39;dimensionless&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">xdis</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">50.0</span><span class="p">,</span> <span class="s1">&#39;centimeter&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">length</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">500.0</span><span class="p">,</span> <span class="s1">&#39;centimeter&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">Th</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">100.0</span><span class="p">,</span> <span class="s1">&#39;centimeter&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">phi00</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="s1">&#39;dimensionless&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">ca00</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.000326</span><span class="p">,</span> <span class="s1">&#39;molar&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">co300</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.000326</span><span class="p">,</span> <span class="s1">&#39;molar&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">ccal00</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;dimensionless&#39;</span><span class="p">)</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">cara00</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="s1">&#39;dimensionless&#39;</span><span class="p">)</span><span class="o">&gt;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#Scenario.__init__"></a>
    
    

                            </div>
                            <div id="Scenario.mua" class="classattr">
                                <div class="attr variable">
            <span class="name">mua</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(100.09, &#39;gram / mole&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.mua"></a>
    
    

                            </div>
                            <div id="Scenario.rhoa" class="classattr">
                                <div class="attr variable">
            <span class="name">rhoa</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(2.95, &#39;gram / centimeter ** 3&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.rhoa"></a>
    
    

                            </div>
                            <div id="Scenario.rhoc" class="classattr">
                                <div class="attr variable">
            <span class="name">rhoc</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(2.71, &#39;gram / centimeter ** 3&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.rhoc"></a>
    
    

                            </div>
                            <div id="Scenario.rhot" class="classattr">
                                <div class="attr variable">
            <span class="name">rhot</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(2.8, &#39;gram / centimeter ** 3&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.rhot"></a>
    
    

                            </div>
                            <div id="Scenario.rhow" class="classattr">
                                <div class="attr variable">
            <span class="name">rhow</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(1.023, &#39;gram / centimeter ** 3&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.rhow"></a>
    
    

                            </div>
                            <div id="Scenario.D0ca" class="classattr">
                                <div class="attr variable">
            <span class="name">D0ca</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(131.9, &#39;centimeter ** 2 / year&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.D0ca"></a>
    
    

                            </div>
                            <div id="Scenario.D0co3" class="classattr">
                                <div class="attr variable">
            <span class="name">D0co3</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(272.6, &#39;centimeter ** 2 / year&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.D0co3"></a>
    
    

                            </div>
                            <div id="Scenario.Ka" class="classattr">
                                <div class="attr variable">
            <span class="name">Ka</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(6.45654229e-07, &#39;molar ** 2&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.Ka"></a>
    
    

                            </div>
                            <div id="Scenario.Kc" class="classattr">
                                <div class="attr variable">
            <span class="name">Kc</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(4.26579519e-07, &#39;molar ** 2&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.Kc"></a>
    
    

                            </div>
                            <div id="Scenario.beta" class="classattr">
                                <div class="attr variable">
            <span class="name">beta</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(0.1, &#39;centimeter / year&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.beta"></a>
    
    

                            </div>
                            <div id="Scenario.b" class="classattr">
                                <div class="attr variable">
            <span class="name">b</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(5.0, &#39;1 / kilopascal&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.b"></a>
    
    

                            </div>
                            <div id="Scenario.k1" class="classattr">
                                <div class="attr variable">
            <span class="name">k1</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(1.0, &#39;1 / year&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.k1"></a>
    
    

                            </div>
                            <div id="Scenario.k2" class="classattr">
                                <div class="attr variable">
            <span class="name">k2</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(1.0, &#39;1 / year&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.k2"></a>
    
    

                            </div>
                            <div id="Scenario.k3" class="classattr">
                                <div class="attr variable">
            <span class="name">k3</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(0.1, &#39;1 / year&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.k3"></a>
    
    

                            </div>
                            <div id="Scenario.k4" class="classattr">
                                <div class="attr variable">
            <span class="name">k4</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(0.1, &#39;1 / year&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.k4"></a>
    
    

                            </div>
                            <div id="Scenario.nn" class="classattr">
                                <div class="attr variable">
            <span class="name">nn</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(2.8, &#39;dimensionless&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.nn"></a>
    
    

                            </div>
                            <div id="Scenario.m" class="classattr">
                                <div class="attr variable">
            <span class="name">m</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(2.48, &#39;dimensionless&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.m"></a>
    
    

                            </div>
                            <div id="Scenario.S" class="classattr">
                                <div class="attr variable">
            <span class="name">S</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(0.1, &#39;centimeter / year&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.S"></a>
    
    

                            </div>
                            <div id="Scenario.phiinf" class="classattr">
                                <div class="attr variable">
            <span class="name">phiinf</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(0.01, &#39;dimensionless&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.phiinf"></a>
    
    

                            </div>
                            <div id="Scenario.phi0" class="classattr">
                                <div class="attr variable">
            <span class="name">phi0</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(0.8, &#39;dimensionless&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.phi0"></a>
    
    

                            </div>
                            <div id="Scenario.ca0" class="classattr">
                                <div class="attr variable">
            <span class="name">ca0</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(0.000326, &#39;molar&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.ca0"></a>
    
    

                            </div>
                            <div id="Scenario.co30" class="classattr">
                                <div class="attr variable">
            <span class="name">co30</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(0.000326, &#39;molar&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.co30"></a>
    
    

                            </div>
                            <div id="Scenario.ccal0" class="classattr">
                                <div class="attr variable">
            <span class="name">ccal0</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(0.3, &#39;dimensionless&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.ccal0"></a>
    
    

                            </div>
                            <div id="Scenario.cara0" class="classattr">
                                <div class="attr variable">
            <span class="name">cara0</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(0.6, &#39;dimensionless&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.cara0"></a>
    
    

                            </div>
                            <div id="Scenario.xdis" class="classattr">
                                <div class="attr variable">
            <span class="name">xdis</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(50.0, &#39;centimeter&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.xdis"></a>
    
    

                            </div>
                            <div id="Scenario.length" class="classattr">
                                <div class="attr variable">
            <span class="name">length</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(500.0, &#39;centimeter&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.length"></a>
    
    

                            </div>
                            <div id="Scenario.Th" class="classattr">
                                <div class="attr variable">
            <span class="name">Th</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(100.0, &#39;centimeter&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.Th"></a>
    
    

                            </div>
                            <div id="Scenario.phi00" class="classattr">
                                <div class="attr variable">
            <span class="name">phi00</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(0.8, &#39;dimensionless&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.phi00"></a>
    
    

                            </div>
                            <div id="Scenario.ca00" class="classattr">
                                <div class="attr variable">
            <span class="name">ca00</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(0.000326, &#39;molar&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.ca00"></a>
    
    

                            </div>
                            <div id="Scenario.co300" class="classattr">
                                <div class="attr variable">
            <span class="name">co300</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(0.000326, &#39;molar&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.co300"></a>
    
    

                            </div>
                            <div id="Scenario.ccal00" class="classattr">
                                <div class="attr variable">
            <span class="name">ccal00</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(0.3, &#39;dimensionless&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.ccal00"></a>
    
    

                            </div>
                            <div id="Scenario.cara00" class="classattr">
                                <div class="attr variable">
            <span class="name">cara00</span><span class="annotation">: pint.Quantity</span>        =
<span class="default_value">&lt;Quantity(0.6, &#39;dimensionless&#39;)&gt;</span>

        
    </div>
    <a class="headerlink" href="#Scenario.cara00"></a>
    
    

                            </div>
                </section>
                <section id="Map_Scenario">
                            <input id="Map_Scenario-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">Map_Scenario</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Map_Scenario-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Map_Scenario"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Map_Scenario-51"><a href="#Map_Scenario-51"><span class="linenos"> 51</span></a><span class="k">def</span> <span class="nf">Map_Scenario</span><span class="p">():</span>
</span><span id="Map_Scenario-52"><a href="#Map_Scenario-52"><span class="linenos"> 52</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Map_Scenario-53"><a href="#Map_Scenario-53"><span class="linenos"> 53</span></a><span class="sd">    Maps the Fortran &#39;Scenario&#39; parameters to the equivalent parameters in the</span>
</span><span id="Map_Scenario-54"><a href="#Map_Scenario-54"><span class="linenos"> 54</span></a><span class="sd">    Matlab and Python codes. These codes use slightly different parameter </span>
</span><span id="Map_Scenario-55"><a href="#Map_Scenario-55"><span class="linenos"> 55</span></a><span class="sd">    names. Besides the mapping, also a few numerical conversions are applied.</span>
</span><span id="Map_Scenario-56"><a href="#Map_Scenario-56"><span class="linenos"> 56</span></a><span class="sd">    To do these conversions, a number of FORTRAN parameters need to be passed on </span>
</span><span id="Map_Scenario-57"><a href="#Map_Scenario-57"><span class="linenos"> 57</span></a><span class="sd">    &quot;as is&quot;, i.e. unchanged.</span>
</span><span id="Map_Scenario-58"><a href="#Map_Scenario-58"><span class="linenos"> 58</span></a><span class="sd">    Units from Scenario are dropped, so only magnitudes (i.e. values) are </span>
</span><span id="Map_Scenario-59"><a href="#Map_Scenario-59"><span class="linenos"> 59</span></a><span class="sd">    retained.</span>
</span><span id="Map_Scenario-60"><a href="#Map_Scenario-60"><span class="linenos"> 60</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="Map_Scenario-61"><a href="#Map_Scenario-61"><span class="linenos"> 61</span></a>    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Ka&quot;</span><span class="p">:</span><span class="s2">&quot;KA&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-62"><a href="#Map_Scenario-62"><span class="linenos"> 62</span></a>               <span class="s2">&quot;Kc&quot;</span><span class="p">:</span><span class="s2">&quot;KC&quot;</span><span class="p">,</span> 
</span><span id="Map_Scenario-63"><a href="#Map_Scenario-63"><span class="linenos"> 63</span></a>               <span class="s2">&quot;cara0&quot;</span><span class="p">:</span> <span class="s2">&quot;CA0&quot;</span><span class="p">,</span> 
</span><span id="Map_Scenario-64"><a href="#Map_Scenario-64"><span class="linenos"> 64</span></a>               <span class="s2">&quot;cara00&quot;</span><span class="p">:</span> <span class="s2">&quot;CAIni&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-65"><a href="#Map_Scenario-65"><span class="linenos"> 65</span></a>               <span class="s2">&quot;ccal0&quot;</span><span class="p">:</span> <span class="s2">&quot;CC0&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-66"><a href="#Map_Scenario-66"><span class="linenos"> 66</span></a>               <span class="s2">&quot;ccal00&quot;</span><span class="p">:</span> <span class="s2">&quot;CCIni&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-67"><a href="#Map_Scenario-67"><span class="linenos"> 67</span></a>               <span class="s2">&quot;ca0&quot;</span><span class="p">:</span> <span class="s2">&quot;ca0&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-68"><a href="#Map_Scenario-68"><span class="linenos"> 68</span></a>               <span class="s2">&quot;ca00&quot;</span><span class="p">:</span> <span class="s2">&quot;ca00&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-69"><a href="#Map_Scenario-69"><span class="linenos"> 69</span></a>               <span class="s2">&quot;co30&quot;</span><span class="p">:</span> <span class="s2">&quot;co30&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-70"><a href="#Map_Scenario-70"><span class="linenos"> 70</span></a>               <span class="s2">&quot;co300&quot;</span><span class="p">:</span> <span class="s2">&quot;co300&quot;</span><span class="p">,</span>               
</span><span id="Map_Scenario-71"><a href="#Map_Scenario-71"><span class="linenos"> 71</span></a>               <span class="s2">&quot;phi0&quot;</span><span class="p">:</span> <span class="s2">&quot;Phi0&quot;</span><span class="p">,</span> 
</span><span id="Map_Scenario-72"><a href="#Map_Scenario-72"><span class="linenos"> 72</span></a>               <span class="s2">&quot;phi00&quot;</span><span class="p">:</span><span class="s2">&quot;PhiIni&quot;</span><span class="p">,</span> 
</span><span id="Map_Scenario-73"><a href="#Map_Scenario-73"><span class="linenos"> 73</span></a>               <span class="s2">&quot;xdis&quot;</span><span class="p">:</span> <span class="s2">&quot;ShallowLimit&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-74"><a href="#Map_Scenario-74"><span class="linenos"> 74</span></a>               <span class="s2">&quot;Th&quot;</span><span class="p">:</span> <span class="s2">&quot;Th&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-75"><a href="#Map_Scenario-75"><span class="linenos"> 75</span></a>               <span class="s2">&quot;S&quot;</span><span class="p">:</span> <span class="s2">&quot;sedimentationrate&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-76"><a href="#Map_Scenario-76"><span class="linenos"> 76</span></a>               <span class="s2">&quot;m&quot;</span><span class="p">:</span> <span class="s2">&quot;m1&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-77"><a href="#Map_Scenario-77"><span class="linenos"> 77</span></a>               <span class="s2">&quot;nn&quot;</span><span class="p">:</span> <span class="s2">&quot;n1&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-78"><a href="#Map_Scenario-78"><span class="linenos"> 78</span></a>               <span class="s2">&quot;rhoa&quot;</span><span class="p">:</span> <span class="s2">&quot;rhoa&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-79"><a href="#Map_Scenario-79"><span class="linenos"> 79</span></a>               <span class="s2">&quot;rhoc&quot;</span><span class="p">:</span> <span class="s2">&quot;rhoc&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-80"><a href="#Map_Scenario-80"><span class="linenos"> 80</span></a>               <span class="s2">&quot;rhot&quot;</span><span class="p">:</span> <span class="s2">&quot;rhot&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-81"><a href="#Map_Scenario-81"><span class="linenos"> 81</span></a>               <span class="s2">&quot;rhow&quot;</span><span class="p">:</span> <span class="s2">&quot;rhow&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-82"><a href="#Map_Scenario-82"><span class="linenos"> 82</span></a>               <span class="s2">&quot;beta&quot;</span><span class="p">:</span> <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-83"><a href="#Map_Scenario-83"><span class="linenos"> 83</span></a>               <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-84"><a href="#Map_Scenario-84"><span class="linenos"> 84</span></a>               <span class="s2">&quot;D0ca&quot;</span><span class="p">:</span> <span class="s2">&quot;D0Ca&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-85"><a href="#Map_Scenario-85"><span class="linenos"> 85</span></a>               <span class="s2">&quot;k1&quot;</span><span class="p">:</span> <span class="s2">&quot;k1&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-86"><a href="#Map_Scenario-86"><span class="linenos"> 86</span></a>               <span class="s2">&quot;k2&quot;</span><span class="p">:</span> <span class="s2">&quot;k2&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-87"><a href="#Map_Scenario-87"><span class="linenos"> 87</span></a>               <span class="s2">&quot;k3&quot;</span><span class="p">:</span> <span class="s2">&quot;k3&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-88"><a href="#Map_Scenario-88"><span class="linenos"> 88</span></a>               <span class="s2">&quot;k4&quot;</span><span class="p">:</span> <span class="s2">&quot;k4&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-89"><a href="#Map_Scenario-89"><span class="linenos"> 89</span></a>               <span class="s2">&quot;mua&quot;</span><span class="p">:</span> <span class="s2">&quot;muA&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-90"><a href="#Map_Scenario-90"><span class="linenos"> 90</span></a>               <span class="s2">&quot;D0co3&quot;</span><span class="p">:</span> <span class="s2">&quot;DCO3&quot;</span><span class="p">,</span>  
</span><span id="Map_Scenario-91"><a href="#Map_Scenario-91"><span class="linenos"> 91</span></a>               <span class="s2">&quot;phiinf&quot;</span><span class="p">:</span> <span class="s2">&quot;PhiInfty&quot;</span><span class="p">,</span>
</span><span id="Map_Scenario-92"><a href="#Map_Scenario-92"><span class="linenos"> 92</span></a>               <span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="s2">&quot;max_depth&quot;</span>
</span><span id="Map_Scenario-93"><a href="#Map_Scenario-93"><span class="linenos"> 93</span></a>    <span class="p">}</span>
</span><span id="Map_Scenario-94"><a href="#Map_Scenario-94"><span class="linenos"> 94</span></a>
</span><span id="Map_Scenario-95"><a href="#Map_Scenario-95"><span class="linenos"> 95</span></a>    <span class="n">all_fields</span> <span class="o">=</span> <span class="n">fields</span><span class="p">(</span><span class="n">Scenario</span><span class="p">)</span>
</span><span id="Map_Scenario-96"><a href="#Map_Scenario-96"><span class="linenos"> 96</span></a>
</span><span id="Map_Scenario-97"><a href="#Map_Scenario-97"><span class="linenos"> 97</span></a>    <span class="n">allowed_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">all_fields</span>
</span><span id="Map_Scenario-98"><a href="#Map_Scenario-98"><span class="linenos"> 98</span></a>                      <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">mapping</span><span class="p">]</span>
</span><span id="Map_Scenario-99"><a href="#Map_Scenario-99"><span class="linenos"> 99</span></a>    
</span><span id="Map_Scenario-100"><a href="#Map_Scenario-100"><span class="linenos">100</span></a>    <span class="n">derived_fields</span> <span class="o">=</span> <span class="p">[(</span><span class="n">mapping</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">field</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">default</span><span class="o">.</span><span class="n">magnitude</span><span class="p">)</span> 
</span><span id="Map_Scenario-101"><a href="#Map_Scenario-101"><span class="linenos">101</span></a>                      <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">allowed_fields</span><span class="p">]</span>
</span><span id="Map_Scenario-102"><a href="#Map_Scenario-102"><span class="linenos">102</span></a>                    
</span><span id="Map_Scenario-103"><a href="#Map_Scenario-103"><span class="linenos">103</span></a>    <span class="c1"># Here we append the fields that cannot be initialised directly from the</span>
</span><span id="Map_Scenario-104"><a href="#Map_Scenario-104"><span class="linenos">104</span></a>    <span class="c1"># Scenario dataclass.</span>
</span><span id="Map_Scenario-105"><a href="#Map_Scenario-105"><span class="linenos">105</span></a>    <span class="n">derived_fields</span><span class="o">.</span><span class="n">extend</span><span class="p">([(</span><span class="s2">&quot;cCa0&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="Map_Scenario-106"><a href="#Map_Scenario-106"><span class="linenos">106</span></a>                           <span class="p">(</span><span class="s2">&quot;cCaIni&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="Map_Scenario-107"><a href="#Map_Scenario-107"><span class="linenos">107</span></a>                           <span class="p">(</span><span class="s2">&quot;cCO30&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="Map_Scenario-108"><a href="#Map_Scenario-108"><span class="linenos">108</span></a>                           <span class="p">(</span><span class="s2">&quot;cCO3Ini&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="Map_Scenario-109"><a href="#Map_Scenario-109"><span class="linenos">109</span></a>                           <span class="p">(</span><span class="s2">&quot;DeepLimit&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="Map_Scenario-110"><a href="#Map_Scenario-110"><span class="linenos">110</span></a>                           <span class="p">(</span><span class="s2">&quot;rhos0&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="Map_Scenario-111"><a href="#Map_Scenario-111"><span class="linenos">111</span></a>                           <span class="p">(</span><span class="s2">&quot;rhos&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="Map_Scenario-112"><a href="#Map_Scenario-112"><span class="linenos">112</span></a>                           <span class="p">(</span><span class="s2">&quot;Xstar&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="Map_Scenario-113"><a href="#Map_Scenario-113"><span class="linenos">113</span></a>                           <span class="p">(</span><span class="s2">&quot;Tstar&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="Map_Scenario-114"><a href="#Map_Scenario-114"><span class="linenos">114</span></a>                           <span class="p">(</span><span class="s2">&quot;m2&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="Map_Scenario-115"><a href="#Map_Scenario-115"><span class="linenos">115</span></a>                           <span class="p">(</span><span class="s2">&quot;n2&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="Map_Scenario-116"><a href="#Map_Scenario-116"><span class="linenos">116</span></a>                           <span class="p">(</span><span class="s2">&quot;DCa&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="Map_Scenario-117"><a href="#Map_Scenario-117"><span class="linenos">117</span></a>                           <span class="p">(</span><span class="s2">&quot;PhiNR&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="Map_Scenario-118"><a href="#Map_Scenario-118"><span class="linenos">118</span></a>                           <span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="Map_Scenario-119"><a href="#Map_Scenario-119"><span class="linenos">119</span></a>                           <span class="p">(</span><span class="s2">&quot;FV_switch&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">)])</span>
</span><span id="Map_Scenario-120"><a href="#Map_Scenario-120"><span class="linenos">120</span></a>
</span><span id="Map_Scenario-121"><a href="#Map_Scenario-121"><span class="linenos">121</span></a>    <span class="k">def</span> <span class="nf">post_init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Map_Scenario-122"><a href="#Map_Scenario-122"><span class="linenos">122</span></a>        <span class="c1"># The Python parameters that need additional conversion</span>
</span><span id="Map_Scenario-123"><a href="#Map_Scenario-123"><span class="linenos">123</span></a>        <span class="c1"># are initialised here.   </span>
</span><span id="Map_Scenario-124"><a href="#Map_Scenario-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cCa0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca0</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">KC</span><span class="p">)</span>
</span><span id="Map_Scenario-125"><a href="#Map_Scenario-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cCaIni</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca00</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">KC</span><span class="p">)</span>
</span><span id="Map_Scenario-126"><a href="#Map_Scenario-126"><span class="linenos">126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cCO30</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">co30</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">KC</span><span class="p">)</span>
</span><span id="Map_Scenario-127"><a href="#Map_Scenario-127"><span class="linenos">127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cCO3Ini</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">co300</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">KC</span><span class="p">)</span>
</span><span id="Map_Scenario-128"><a href="#Map_Scenario-128"><span class="linenos">128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DeepLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ShallowLimit</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Th</span>
</span><span id="Map_Scenario-129"><a href="#Map_Scenario-129"><span class="linenos">129</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rhos0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rhoa</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">CA0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rhoc</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">CC0</span> <span class="o">+</span> \
</span><span id="Map_Scenario-130"><a href="#Map_Scenario-130"><span class="linenos">130</span></a>                     <span class="bp">self</span><span class="o">.</span> <span class="n">rhot</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CA0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">CC0</span><span class="p">))</span>
</span><span id="Map_Scenario-131"><a href="#Map_Scenario-131"><span class="linenos">131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rhos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rhos0</span>
</span><span id="Map_Scenario-132"><a href="#Map_Scenario-132"><span class="linenos">132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Xstar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">D0Ca</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sedimentationrate</span>
</span><span id="Map_Scenario-133"><a href="#Map_Scenario-133"><span class="linenos">133</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Tstar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Xstar</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sedimentationrate</span>
</span><span id="Map_Scenario-134"><a href="#Map_Scenario-134"><span class="linenos">134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">/</span><span class="mf">1e4</span><span class="p">)</span> 
</span><span id="Map_Scenario-135"><a href="#Map_Scenario-135"><span class="linenos">135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m1</span>
</span><span id="Map_Scenario-136"><a href="#Map_Scenario-136"><span class="linenos">136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n1</span>
</span><span id="Map_Scenario-137"><a href="#Map_Scenario-137"><span class="linenos">137</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DCa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">D0Ca</span>
</span><span id="Map_Scenario-138"><a href="#Map_Scenario-138"><span class="linenos">138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">PhiNR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PhiIni</span>
</span><span id="Map_Scenario-139"><a href="#Map_Scenario-139"><span class="linenos">139</span></a>        <span class="c1"># The number of cells that comprise the grid.</span>
</span><span id="Map_Scenario-140"><a href="#Map_Scenario-140"><span class="linenos">140</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="mi">200</span>
</span><span id="Map_Scenario-141"><a href="#Map_Scenario-141"><span class="linenos">141</span></a>        <span class="c1"># It could be that F-V caused instabilities instead of resolving them,</span>
</span><span id="Map_Scenario-142"><a href="#Map_Scenario-142"><span class="linenos">142</span></a>        <span class="c1"># e.g. in the case of oscillations.</span>
</span><span id="Map_Scenario-143"><a href="#Map_Scenario-143"><span class="linenos">143</span></a>        <span class="c1"># FV_switch = 1 will use the Fiadeiro-Veronis scheme for spatial derivatives.</span>
</span><span id="Map_Scenario-144"><a href="#Map_Scenario-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">FV_switch</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Map_Scenario-145"><a href="#Map_Scenario-145"><span class="linenos">145</span></a>               
</span><span id="Map_Scenario-146"><a href="#Map_Scenario-146"><span class="linenos">146</span></a>    <span class="n">derived_dataclass</span> <span class="o">=</span> <span class="n">make_dataclass</span><span class="p">(</span><span class="s2">&quot;Mapped parameters&quot;</span><span class="p">,</span> <span class="n">derived_fields</span><span class="p">,</span>
</span><span id="Map_Scenario-147"><a href="#Map_Scenario-147"><span class="linenos">147</span></a>                                       <span class="n">namespace</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;__post_init__&quot;</span><span class="p">:</span> <span class="n">post_init</span><span class="p">})</span>
</span><span id="Map_Scenario-148"><a href="#Map_Scenario-148"><span class="linenos">148</span></a>
</span><span id="Map_Scenario-149"><a href="#Map_Scenario-149"><span class="linenos">149</span></a>    <span class="k">return</span> <span class="n">derived_dataclass</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Maps the Fortran 'Scenario' parameters to the equivalent parameters in the
Matlab and Python codes. These codes use slightly different parameter 
names. Besides the mapping, also a few numerical conversions are applied.
To do these conversions, a number of FORTRAN parameters need to be passed on 
"as is", i.e. unchanged.
Units from Scenario are dropped, so only magnitudes (i.e. values) are 
retained.</p>
</div>


                </section>
                <section id="jacobian_sparsity">
                            <input id="jacobian_sparsity-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">jacobian_sparsity</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="jacobian_sparsity-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#jacobian_sparsity"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="jacobian_sparsity-151"><a href="#jacobian_sparsity-151"><span class="linenos">151</span></a><span class="k">def</span> <span class="nf">jacobian_sparsity</span><span class="p">():</span>
</span><span id="jacobian_sparsity-152"><a href="#jacobian_sparsity-152"><span class="linenos">152</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="jacobian_sparsity-153"><a href="#jacobian_sparsity-153"><span class="linenos">153</span></a><span class="sd">    It turns out the the Jacobian sparsity matrix, as provided by</span>
</span><span id="jacobian_sparsity-154"><a href="#jacobian_sparsity-154"><span class="linenos">154</span></a><span class="sd">    previous versions of this function was too strict. The diagonals</span>
</span><span id="jacobian_sparsity-155"><a href="#jacobian_sparsity-155"><span class="linenos">155</span></a><span class="sd">    had a width of 1, this implicitly assumes no dependencies of the</span>
</span><span id="jacobian_sparsity-156"><a href="#jacobian_sparsity-156"><span class="linenos">156</span></a><span class="sd">    Jacobian elements on fields at adjacent depths. A run with such</span>
</span><span id="jacobian_sparsity-157"><a href="#jacobian_sparsity-157"><span class="linenos">157</span></a><span class="sd">    a Jacobian sparsity matrix took a lot of compute power and time and</span>
</span><span id="jacobian_sparsity-158"><a href="#jacobian_sparsity-158"><span class="linenos">158</span></a><span class="sd">    ultimately halted without covering a single time step! A debugging </span>
</span><span id="jacobian_sparsity-159"><a href="#jacobian_sparsity-159"><span class="linenos">159</span></a><span class="sd">    session with breakpoints inside solve_ivp showed that the Jacobian </span>
</span><span id="jacobian_sparsity-160"><a href="#jacobian_sparsity-160"><span class="linenos">160</span></a><span class="sd">    matrix computed by `solve_ivp` (when neither the Jacobian nor the </span>
</span><span id="jacobian_sparsity-161"><a href="#jacobian_sparsity-161"><span class="linenos">161</span></a><span class="sd">    Jacobian sparsity matrix was provided) has non-zero elements not </span>
</span><span id="jacobian_sparsity-162"><a href="#jacobian_sparsity-162"><span class="linenos">162</span></a><span class="sd">    only on the diagonals but also on adjacent positions along the </span>
</span><span id="jacobian_sparsity-163"><a href="#jacobian_sparsity-163"><span class="linenos">163</span></a><span class="sd">    diagonals. </span>
</span><span id="jacobian_sparsity-164"><a href="#jacobian_sparsity-164"><span class="linenos">164</span></a><span class="sd">    See equation 2.58 from &quot;Finite Difference Methods Finite for Differential</span>
</span><span id="jacobian_sparsity-165"><a href="#jacobian_sparsity-165"><span class="linenos">165</span></a><span class="sd">    Equations by Randall J. Leveque for an example of off-diagonal Jacobian</span>
</span><span id="jacobian_sparsity-166"><a href="#jacobian_sparsity-166"><span class="linenos">166</span></a><span class="sd">    matrix elements. This example is about the Jacobian for solving the pde </span>
</span><span id="jacobian_sparsity-167"><a href="#jacobian_sparsity-167"><span class="linenos">167</span></a><span class="sd">    describing the motion of a pendulum with a certain mass at the end of a </span>
</span><span id="jacobian_sparsity-168"><a href="#jacobian_sparsity-168"><span class="linenos">168</span></a><span class="sd">    rigid (but massless) bar.</span>
</span><span id="jacobian_sparsity-169"><a href="#jacobian_sparsity-169"><span class="linenos">169</span></a>
</span><span id="jacobian_sparsity-170"><a href="#jacobian_sparsity-170"><span class="linenos">170</span></a><span class="sd">    Here we will choose diagonals of width 3.</span>
</span><span id="jacobian_sparsity-171"><a href="#jacobian_sparsity-171"><span class="linenos">171</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="jacobian_sparsity-172"><a href="#jacobian_sparsity-172"><span class="linenos">172</span></a>
</span><span id="jacobian_sparsity-173"><a href="#jacobian_sparsity-173"><span class="linenos">173</span></a>    <span class="n">no_depths</span> <span class="o">=</span> <span class="n">Map_Scenario</span><span class="p">()</span><span class="o">.</span><span class="n">N</span>
</span><span id="jacobian_sparsity-174"><a href="#jacobian_sparsity-174"><span class="linenos">174</span></a>    <span class="c1"># Number of fields = 5, i.e. calcite, aragonite, concentrations of</span>
</span><span id="jacobian_sparsity-175"><a href="#jacobian_sparsity-175"><span class="linenos">175</span></a>    <span class="c1"># calcium and carbonate ions and the porosity.</span>
</span><span id="jacobian_sparsity-176"><a href="#jacobian_sparsity-176"><span class="linenos">176</span></a>    <span class="n">no_fields</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="jacobian_sparsity-177"><a href="#jacobian_sparsity-177"><span class="linenos">177</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">no_fields</span> <span class="o">*</span> <span class="n">no_depths</span>
</span><span id="jacobian_sparsity-178"><a href="#jacobian_sparsity-178"><span class="linenos">178</span></a>    
</span><span id="jacobian_sparsity-179"><a href="#jacobian_sparsity-179"><span class="linenos">179</span></a>    <span class="n">diagonals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">no_fields</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">n</span><span class="p">))</span>
</span><span id="jacobian_sparsity-180"><a href="#jacobian_sparsity-180"><span class="linenos">180</span></a>
</span><span id="jacobian_sparsity-181"><a href="#jacobian_sparsity-181"><span class="linenos">181</span></a>    <span class="c1"># Construct the offsets.</span>
</span><span id="jacobian_sparsity-182"><a href="#jacobian_sparsity-182"><span class="linenos">182</span></a>    <span class="n">offsets</span> <span class="o">=</span> <span class="p">()</span>
</span><span id="jacobian_sparsity-183"><a href="#jacobian_sparsity-183"><span class="linenos">183</span></a>    <span class="k">for</span> <span class="n">offset</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">n</span> <span class="o">+</span> <span class="n">no_depths</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="n">no_depths</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">no_depths</span><span class="p">):</span> 
</span><span id="jacobian_sparsity-184"><a href="#jacobian_sparsity-184"><span class="linenos">184</span></a>        <span class="n">offsets</span> <span class="o">=</span> <span class="n">offsets</span> <span class="o">+</span> <span class="p">((</span><span class="n">offset</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">offset</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),)</span>
</span><span id="jacobian_sparsity-185"><a href="#jacobian_sparsity-185"><span class="linenos">185</span></a>    <span class="c1"># Turn offsets into a single tuple instead of a tuple of tuples.</span>
</span><span id="jacobian_sparsity-186"><a href="#jacobian_sparsity-186"><span class="linenos">186</span></a>    <span class="n">offsets</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">offsets</span><span class="p">,</span> <span class="p">())</span>
</span><span id="jacobian_sparsity-187"><a href="#jacobian_sparsity-187"><span class="linenos">187</span></a>    <span class="c1"># Check that we have as many offsets as diagonals:</span>
</span><span id="jacobian_sparsity-188"><a href="#jacobian_sparsity-188"><span class="linenos">188</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="jacobian_sparsity-189"><a href="#jacobian_sparsity-189"><span class="linenos">189</span></a>        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">offsets</span><span class="p">)</span> <span class="o">==</span> <span class="n">diagonals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="jacobian_sparsity-190"><a href="#jacobian_sparsity-190"><span class="linenos">190</span></a>    <span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="jacobian_sparsity-191"><a href="#jacobian_sparsity-191"><span class="linenos">191</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Assertion failed at the </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s1"> line. </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="jacobian_sparsity-192"><a href="#jacobian_sparsity-192"><span class="linenos">192</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Setup of diagonals incorrect.&#39;</span><span class="p">)</span>
</span><span id="jacobian_sparsity-193"><a href="#jacobian_sparsity-193"><span class="linenos">193</span></a>
</span><span id="jacobian_sparsity-194"><a href="#jacobian_sparsity-194"><span class="linenos">194</span></a>    <span class="c1"># Construct the sparse matrix. </span>
</span><span id="jacobian_sparsity-195"><a href="#jacobian_sparsity-195"><span class="linenos">195</span></a>    <span class="n">raw_matrix</span> <span class="o">=</span> <span class="n">lil_matrix</span><span class="p">(</span><span class="n">dia_matrix</span><span class="p">((</span><span class="n">diagonals</span><span class="p">,</span> <span class="n">offsets</span><span class="p">),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)))</span> 
</span><span id="jacobian_sparsity-196"><a href="#jacobian_sparsity-196"><span class="linenos">196</span></a>    <span class="c1"># Set the Jacobian elements to zero that correspond with the derivatives</span>
</span><span id="jacobian_sparsity-197"><a href="#jacobian_sparsity-197"><span class="linenos">197</span></a>    <span class="c1"># of the rhs of equations 40 and 41 wrt phi.</span>
</span><span id="jacobian_sparsity-198"><a href="#jacobian_sparsity-198"><span class="linenos">198</span></a>    <span class="n">raw_matrix</span><span class="p">[:</span><span class="mi">2</span> <span class="o">*</span> <span class="n">no_depths</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">no_depths</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="jacobian_sparsity-199"><a href="#jacobian_sparsity-199"><span class="linenos">199</span></a>
</span><span id="jacobian_sparsity-200"><a href="#jacobian_sparsity-200"><span class="linenos">200</span></a>    <span class="k">return</span> <span class="n">csr_matrix</span><span class="p">(</span><span class="n">raw_matrix</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>It turns out the the Jacobian sparsity matrix, as provided by
previous versions of this function was too strict. The diagonals
had a width of 1, this implicitly assumes no dependencies of the
Jacobian elements on fields at adjacent depths. A run with such
a Jacobian sparsity matrix took a lot of compute power and time and
ultimately halted without covering a single time step! A debugging 
session with breakpoints inside solve_ivp showed that the Jacobian 
matrix computed by <code>solve_ivp</code> (when neither the Jacobian nor the 
Jacobian sparsity matrix was provided) has non-zero elements not 
only on the diagonals but also on adjacent positions along the 
diagonals. 
See equation 2.58 from "Finite Difference Methods Finite for Differential
Equations by Randall J. Leveque for an example of off-diagonal Jacobian
matrix elements. This example is about the Jacobian for solving the pde 
describing the motion of a pendulum with a certain mass at the end of a 
rigid (but massless) bar.</p>

<p>Here we will choose diagonals of width 3.</p>
</div>


                </section>
                <section id="Solver">
                            <input id="Solver-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass</div>

    <span class="def">class</span>
    <span class="name">Solver</span>:

                <label class="view-source-button" for="Solver-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Solver"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Solver-202"><a href="#Solver-202"><span class="linenos">202</span></a><span class="nd">@dataclass</span>
</span><span id="Solver-203"><a href="#Solver-203"><span class="linenos">203</span></a><span class="k">class</span> <span class="nc">Solver</span><span class="p">():</span>
</span><span id="Solver-204"><a href="#Solver-204"><span class="linenos">204</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Solver-205"><a href="#Solver-205"><span class="linenos">205</span></a><span class="sd">    Initialises all the parameters for the solver.</span>
</span><span id="Solver-206"><a href="#Solver-206"><span class="linenos">206</span></a><span class="sd">    So parameters like time interval, time step and tolerance.</span>
</span><span id="Solver-207"><a href="#Solver-207"><span class="linenos">207</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="Solver-208"><a href="#Solver-208"><span class="linenos">208</span></a>    <span class="n">first_step</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span>
</span><span id="Solver-209"><a href="#Solver-209"><span class="linenos">209</span></a>    <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span>
</span><span id="Solver-210"><a href="#Solver-210"><span class="linenos">210</span></a>    <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span>
</span><span id="Solver-211"><a href="#Solver-211"><span class="linenos">211</span></a>    <span class="c1"># t_span is a tuple (begin time, end time) of integration in units of T*.</span>
</span><span id="Solver-212"><a href="#Solver-212"><span class="linenos">212</span></a>    <span class="n">t_span</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Solver-213"><a href="#Solver-213"><span class="linenos">213</span></a>    <span class="c1"># solve_ivp from scipy offers six methods. They can be set here.</span>
</span><span id="Solver-214"><a href="#Solver-214"><span class="linenos">214</span></a>    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Radau&quot;</span>
</span><span id="Solver-215"><a href="#Solver-215"><span class="linenos">215</span></a>    <span class="c1"># Setting lband and uband for method=&quot;LSODA&quot; leads to tremendous performance</span>
</span><span id="Solver-216"><a href="#Solver-216"><span class="linenos">216</span></a>    <span class="c1"># increase. See Scipy&#39;s solve_ivp documentation for background. Consider it</span>
</span><span id="Solver-217"><a href="#Solver-217"><span class="linenos">217</span></a>    <span class="c1"># equivalent to providing a sparsity matrix for the &quot;Radau&quot; and &quot;BDF&quot;</span>
</span><span id="Solver-218"><a href="#Solver-218"><span class="linenos">218</span></a>    <span class="c1"># implicit methods.</span>
</span><span id="Solver-219"><a href="#Solver-219"><span class="linenos">219</span></a>    <span class="n">lband</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Solver-220"><a href="#Solver-220"><span class="linenos">220</span></a>    <span class="n">uband</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Solver-221"><a href="#Solver-221"><span class="linenos">221</span></a>    <span class="n">backend</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;numba&quot;</span>
</span><span id="Solver-222"><a href="#Solver-222"><span class="linenos">222</span></a>    <span class="n">dense_output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Solver-223"><a href="#Solver-223"><span class="linenos">223</span></a>    <span class="n">jac_sparsity</span><span class="p">:</span> <span class="n">csr_matrix</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Solver-224"><a href="#Solver-224"><span class="linenos">224</span></a>    
</span><span id="Solver-225"><a href="#Solver-225"><span class="linenos">225</span></a>    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Solver-226"><a href="#Solver-226"><span class="linenos">226</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Solver-227"><a href="#Solver-227"><span class="linenos">227</span></a><span class="sd">        Filter out solver settings that are mutually incompatible.</span>
</span><span id="Solver-228"><a href="#Solver-228"><span class="linenos">228</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Solver-229"><a href="#Solver-229"><span class="linenos">229</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Solver-230"><a href="#Solver-230"><span class="linenos">230</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;LSODA&quot;</span><span class="p">:</span>
</span><span id="Solver-231"><a href="#Solver-231"><span class="linenos">231</span></a>                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dataclass_fields__</span><span class="p">[</span><span class="s2">&quot;jac_sparsity&quot;</span><span class="p">]</span>
</span><span id="Solver-232"><a href="#Solver-232"><span class="linenos">232</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Solver-233"><a href="#Solver-233"><span class="linenos">233</span></a>                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dataclass_fields__</span><span class="p">[</span><span class="s2">&quot;lband&quot;</span><span class="p">]</span>
</span><span id="Solver-234"><a href="#Solver-234"><span class="linenos">234</span></a>                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dataclass_fields__</span><span class="p">[</span><span class="s2">&quot;uband&quot;</span><span class="p">]</span>
</span><span id="Solver-235"><a href="#Solver-235"><span class="linenos">235</span></a>                
</span><span id="Solver-236"><a href="#Solver-236"><span class="linenos">236</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;Radau&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;BDF&quot;</span><span class="p">:</span>
</span><span id="Solver-237"><a href="#Solver-237"><span class="linenos">237</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">jac_sparsity</span> <span class="o">=</span> <span class="n">jacobian_sparsity</span><span class="p">()</span>
</span><span id="Solver-238"><a href="#Solver-238"><span class="linenos">238</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Solver-239"><a href="#Solver-239"><span class="linenos">239</span></a>                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dataclass_fields__</span><span class="p">[</span><span class="s2">&quot;jac_sparsity&quot;</span><span class="p">]</span>
</span><span id="Solver-240"><a href="#Solver-240"><span class="linenos">240</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="Solver-241"><a href="#Solver-241"><span class="linenos">241</span></a>            <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Initialises all the parameters for the solver.
So parameters like time interval, time step and tolerance.</p>
</div>


                            <div id="Solver.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">Solver</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">first_step</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-06</span>,</span><span class="param">	<span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.001</span>,</span><span class="param">	<span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.001</span>,</span><span class="param">	<span class="n">t_span</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>,</span><span class="param">	<span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Radau&#39;</span>,</span><span class="param">	<span class="n">lband</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">uband</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">backend</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;numba&#39;</span>,</span><span class="param">	<span class="n">dense_output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">jac_sparsity</span><span class="p">:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">_csr</span><span class="o">.</span><span class="n">csr_matrix</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#Solver.__init__"></a>
    
    

                            </div>
                            <div id="Solver.first_step" class="classattr">
                                <div class="attr variable">
            <span class="name">first_step</span><span class="annotation">: float</span>        =
<span class="default_value">1e-06</span>

        
    </div>
    <a class="headerlink" href="#Solver.first_step"></a>
    
    

                            </div>
                            <div id="Solver.atol" class="classattr">
                                <div class="attr variable">
            <span class="name">atol</span><span class="annotation">: float</span>        =
<span class="default_value">0.001</span>

        
    </div>
    <a class="headerlink" href="#Solver.atol"></a>
    
    

                            </div>
                            <div id="Solver.rtol" class="classattr">
                                <div class="attr variable">
            <span class="name">rtol</span><span class="annotation">: float</span>        =
<span class="default_value">0.001</span>

        
    </div>
    <a class="headerlink" href="#Solver.rtol"></a>
    
    

                            </div>
                            <div id="Solver.t_span" class="classattr">
                                <div class="attr variable">
            <span class="name">t_span</span><span class="annotation">: tuple</span>        =
<span class="default_value">(0, 1)</span>

        
    </div>
    <a class="headerlink" href="#Solver.t_span"></a>
    
    

                            </div>
                            <div id="Solver.method" class="classattr">
                                <div class="attr variable">
            <span class="name">method</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;Radau&#39;</span>

        
    </div>
    <a class="headerlink" href="#Solver.method"></a>
    
    

                            </div>
                            <div id="Solver.lband" class="classattr">
                                <div class="attr variable">
            <span class="name">lband</span><span class="annotation">: int</span>        =
<span class="default_value">1</span>

        
    </div>
    <a class="headerlink" href="#Solver.lband"></a>
    
    

                            </div>
                            <div id="Solver.uband" class="classattr">
                                <div class="attr variable">
            <span class="name">uband</span><span class="annotation">: int</span>        =
<span class="default_value">1</span>

        
    </div>
    <a class="headerlink" href="#Solver.uband"></a>
    
    

                            </div>
                            <div id="Solver.backend" class="classattr">
                                <div class="attr variable">
            <span class="name">backend</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;numba&#39;</span>

        
    </div>
    <a class="headerlink" href="#Solver.backend"></a>
    
    

                            </div>
                            <div id="Solver.dense_output" class="classattr">
                                <div class="attr variable">
            <span class="name">dense_output</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#Solver.dense_output"></a>
    
    

                            </div>
                            <div id="Solver.jac_sparsity" class="classattr">
                                <div class="attr variable">
            <span class="name">jac_sparsity</span><span class="annotation">: scipy.sparse._csr.csr_matrix</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Solver.jac_sparsity"></a>
    
    

                            </div>
                </section>
                <section id="Tracker">
                            <input id="Tracker-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass</div>

    <span class="def">class</span>
    <span class="name">Tracker</span>:

                <label class="view-source-button" for="Tracker-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tracker"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tracker-244"><a href="#Tracker-244"><span class="linenos">244</span></a><span class="nd">@dataclass</span>
</span><span id="Tracker-245"><a href="#Tracker-245"><span class="linenos">245</span></a><span class="k">class</span> <span class="nc">Tracker</span><span class="p">:</span>
</span><span id="Tracker-246"><a href="#Tracker-246"><span class="linenos">246</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Tracker-247"><a href="#Tracker-247"><span class="linenos">247</span></a><span class="sd">    Settings for tracking progress and for storing intermediate results when </span>
</span><span id="Tracker-248"><a href="#Tracker-248"><span class="linenos">248</span></a><span class="sd">    solve_ivp runs.</span>
</span><span id="Tracker-249"><a href="#Tracker-249"><span class="linenos">249</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="Tracker-250"><a href="#Tracker-250"><span class="linenos">250</span></a>    <span class="c1"># Number of progress updates. This only affects the progress bar.</span>
</span><span id="Tracker-251"><a href="#Tracker-251"><span class="linenos">251</span></a>    <span class="n">no_progress_updates</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100_000</span>
</span><span id="Tracker-252"><a href="#Tracker-252"><span class="linenos">252</span></a>
</span><span id="Tracker-253"><a href="#Tracker-253"><span class="linenos">253</span></a>    <span class="c1"># Number of times to evaluate, for storage.</span>
</span><span id="Tracker-254"><a href="#Tracker-254"><span class="linenos">254</span></a>    <span class="c1"># 2 means only initial and end values.</span>
</span><span id="Tracker-255"><a href="#Tracker-255"><span class="linenos">255</span></a>    <span class="n">no_t_eval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Tracker-256"><a href="#Tracker-256"><span class="linenos">256</span></a>
</span><span id="Tracker-257"><a href="#Tracker-257"><span class="linenos">257</span></a>
</span><span id="Tracker-258"><a href="#Tracker-258"><span class="linenos">258</span></a>    <span class="c1"># Array with all times that solutions from solve_ivp should be recorded.</span>
</span><span id="Tracker-259"><a href="#Tracker-259"><span class="linenos">259</span></a>    <span class="n">t_eval</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Tracker-260"><a href="#Tracker-260"><span class="linenos">260</span></a>
</span><span id="Tracker-261"><a href="#Tracker-261"><span class="linenos">261</span></a>    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Tracker-262"><a href="#Tracker-262"><span class="linenos">262</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">Solver</span><span class="p">()</span><span class="o">.</span><span class="n">t_span</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_t_eval</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Settings for tracking progress and for storing intermediate results when 
solve_ivp runs.</p>
</div>


                            <div id="Tracker.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">Tracker</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">no_progress_updates</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100000</span>,</span><span class="param">	<span class="n">no_t_eval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>,</span><span class="param">	<span class="n">t_eval</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#Tracker.__init__"></a>
    
    

                            </div>
                            <div id="Tracker.no_progress_updates" class="classattr">
                                <div class="attr variable">
            <span class="name">no_progress_updates</span><span class="annotation">: int</span>        =
<span class="default_value">100000</span>

        
    </div>
    <a class="headerlink" href="#Tracker.no_progress_updates"></a>
    
    

                            </div>
                            <div id="Tracker.no_t_eval" class="classattr">
                                <div class="attr variable">
            <span class="name">no_t_eval</span><span class="annotation">: int</span>        =
<span class="default_value">2</span>

        
    </div>
    <a class="headerlink" href="#Tracker.no_t_eval"></a>
    
    

                            </div>
                            <div id="Tracker.t_eval" class="classattr">
                                <div class="attr variable">
            <span class="name">t_eval</span><span class="annotation">: numpy.ndarray</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Tracker.t_eval"></a>
    
    

                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>